[{"name":"app.R","content":"library(shiny)\r\nlibrary(bslib)\r\nlibrary(ggplot2)\r\n\r\nui <- fluidPage(\r\n  theme = bslib::bs_theme(bootswatch = \"lux\"),\r\n  titlePanel(\r\n    h1(\"Central Limit Theorm\", align = \"center\")\r\n  ),\r\n  fluidRow(\r\n    column(10,\r\n           align=\"center\",\r\n    span(\"The sampling distribution of the mean will always be normally distributed, as long as the sample size is large enough.\")\r\n    ),\r\n    column(2,\r\n           align=\"center\",\r\n           HTML(\"<span>Created by <a href='https://zehuiyin.github.io/' target='_blank'>Zehui Yin<\/a><\/span>\")\r\n    ),\r\n  ),\r\n  fluidRow(\r\n    column(6,\r\n           align=\"center\",\r\n           selectInput(\"pop_dist\", \"Data Generating Process\", \r\n                       choices = c(\r\n                         \"Normal Distribution\" = \"norm\",\r\n                         \"Uniform Distribution\" = \"unif\",\r\n                         \"Poisson Distribution\" = \"poiss\",\r\n                         \"Chi-squared distribution\" = \"chiq\",\r\n                         \"F-distribution\" = \"F\"\r\n                       ),\r\n                       selected = \"unif\"\r\n                       )\r\n    ),\r\n    column(6,\r\n           align=\"center\",\r\n      sliderInput(\"sample_size\", \"Sample Size\", min = 0, max = 1000, value = 50)\r\n    )\r\n  ),\r\n  fluidRow(\r\n    column(6,\r\n           align=\"center\",\r\n           uiOutput(\"para1\")\r\n    ),\r\n    column(6,\r\n           align=\"center\",\r\n           uiOutput(\"para2\")\r\n    )\r\n  ),\r\n  fluidRow(\r\n    column(4,\r\n           align=\"center\",\r\n           plotOutput(\"one_hist_sample\")\r\n    ),\r\n    column(4,\r\n           align=\"center\",\r\n      plotOutput(\"hist_sample_mean\")\r\n    ),\r\n    column(4,\r\n           align=\"center\",\r\n      plotOutput(\"qq_sample_mean\")\r\n    )\r\n  )\r\n)\r\n\r\nserver <- function(input, output, session) {\r\n  output$para1 <- renderUI({\r\n    if (input$pop_dist == \"norm\") {\r\n      sliderInput(\"normal_mean\", \"Mean\", min = -30, max = 30, value = 0)\r\n    } else if (input$pop_dist == \"unif\") {\r\n      sliderInput(\"unif_min\", \"Min\", min = -30, max = 30, value = 0)\r\n    } else if (input$pop_dist == \"poiss\") {\r\n      sliderInput(\"poiss_lambda\", \"Lambda\", min = 0, max = 30, value = 5)\r\n    } else if (input$pop_dist == \"chiq\") {\r\n      sliderInput(\"chiq_df\", \"df\", min = 0, max = 30, value = 5)\r\n    } else if (input$pop_dist == \"F\") {\r\n      sliderInput(\"f_df1\", \"df1\", min = 0, max = 30, value = 5)\r\n    }\r\n  })\r\n  \r\n  output$para2 <- renderUI({\r\n    if (input$pop_dist == \"norm\") {\r\n      sliderInput(\"norm_sd\", \"SD\", min = 0, max = 30, value = 5)\r\n    } else if (input$pop_dist == \"unif\") {\r\n      sliderInput(\"unif_max\", \"Max\", min = -30, max = 30, value = 10)\r\n    } else if (input$pop_dist == \"poiss\") {\r\n\r\n    } else if (input$pop_dist == \"chiq\") {\r\n\r\n    } else if (input$pop_dist == \"F\") {\r\n      sliderInput(\"f_df2\", \"df2\", min = 0, max = 30, value = 5)\r\n    }\r\n  })\r\n  \r\n  samples <- reactive({\r\n    req(input$pop_dist)\r\n    req(input$sample_size)\r\n    \r\n    if (input$pop_dist == \"norm\") {\r\n      req(input$normal_mean)\r\n      req(input$norm_sd)\r\n      \r\n      data <- data.frame(\r\n        x = sample(rnorm(input$sample_size,\r\n                         mean = input$normal_mean,\r\n                         sd = input$norm_sd))\r\n      )\r\n    }\r\n    \r\n    if (input$pop_dist == \"unif\") {\r\n      req(input$unif_min)\r\n      req(input$unif_max)\r\n      \r\n      data <- data.frame(\r\n        x = sample(runif(input$sample_size,\r\n                         min = input$unif_min,\r\n                         max = input$unif_max))\r\n      )\r\n    }\r\n    \r\n    if (input$pop_dist == \"poiss\") {\r\n      req(input$poiss_lambda)\r\n      \r\n      data <- data.frame(\r\n        x = sample(rpois(input$sample_size,\r\n                         lambda = input$poiss_lambda))\r\n      )\r\n    }\r\n    \r\n    if (input$pop_dist == \"chiq\") {\r\n      req(input$chiq_df)\r\n      \r\n      data <- data.frame(\r\n        x = sample(rchisq(input$sample_size,\r\n                          df = input$chiq_df))\r\n      )\r\n    }\r\n    \r\n    if (input$pop_dist == \"F\") {\r\n      req(input$f_df1)\r\n      req(input$f_df2)\r\n      \r\n      data <- data.frame(\r\n        x = sample(rf(input$sample_size,\r\n                      df1 = input$f_df1,\r\n                      df2 = input$f_df2))\r\n      )\r\n    }\r\n    \r\n    data\r\n  })\r\n  \r\n  means <- reactive({\r\n    req(input$pop_dist)\r\n    req(input$sample_size)\r\n    \r\n    if (input$pop_dist == \"norm\") {\r\n      req(input$normal_mean)\r\n      req(input$norm_sd)\r\n      \r\n      data <- data.frame(\r\n        x = replicate(1e4, mean(sample(rnorm(input$sample_size,\r\n                         mean = input$normal_mean,\r\n                         sd = input$norm_sd))))\r\n      )\r\n    }\r\n    \r\n    if (input$pop_dist == \"unif\") {\r\n      req(input$unif_min)\r\n      req(input$unif_max)\r\n      \r\n      data <- data.frame(\r\n        x = replicate(1e4, mean(sample(runif(input$sample_size,\r\n                         min = input$unif_min,\r\n                         max = input$unif_max))))\r\n      )\r\n    }\r\n    \r\n    if (input$pop_dist == \"poiss\") {\r\n      req(input$poiss_lambda)\r\n      \r\n      data <- data.frame(\r\n        x = replicate(1e4, mean(sample(rpois(input$sample_size,\r\n                         lambda = input$poiss_lambda))))\r\n      )\r\n    }\r\n    \r\n    if (input$pop_dist == \"chiq\") {\r\n      req(input$chiq_df)\r\n      \r\n      data <- data.frame(\r\n        x = replicate(1e4, mean(sample(rchisq(input$sample_size,\r\n                          df = input$chiq_df))))\r\n      )\r\n    }\r\n    \r\n    if (input$pop_dist == \"F\") {\r\n      req(input$f_df1)\r\n      req(input$f_df2)\r\n      \r\n      data <- data.frame(\r\n        x = replicate(1e4, mean(sample(rf(input$sample_size,\r\n                      df1 = input$f_df1,\r\n                      df2 = input$f_df2))))\r\n      )\r\n    }\r\n    \r\n    data\r\n  })\r\n  \r\n  output$one_hist_sample <- renderPlot({\r\n    ggplot(samples(), aes(x = x)) + \r\n      geom_histogram(bins = round(log(input$sample_size,2)+1)) +\r\n      labs(x = \"Data Values\",\r\n           y = \"Frequencies\",\r\n           title = \"Histogram of One Sample\") +\r\n      theme(panel.background = element_blank(),\r\n            panel.border = element_rect(color = \"black\", fill = NA),\r\n            plot.title = element_text(hjust = 0.5))\r\n  })\r\n  \r\n  output$hist_sample_mean <- renderPlot({\r\n    ggplot(means(), aes(x = x)) + \r\n      geom_histogram(bins = round(log(1e4,2)+1)) +\r\n      labs(x = \"Sample Means\",\r\n           y = \"Frequencies\",\r\n           title = \"Histogram of Sample Means\") +\r\n      theme(panel.background = element_blank(),\r\n            panel.border = element_rect(color = \"black\", fill = NA),\r\n            plot.title = element_text(hjust = 0.5))\r\n  })\r\n  \r\n  output$qq_sample_mean <- renderPlot({\r\n    ggplot(means(), aes(sample = x)) + \r\n      stat_qq() +stat_qq_line() +\r\n      labs(x = \"Theotical Quantiles\",\r\n           y = \"Sample Quantiles\",\r\n           title = \"Normal Quantile Plot of Sample Means\") +\r\n      theme(panel.background = element_blank(),\r\n            panel.border = element_rect(color = \"black\", fill = NA),\r\n            plot.title = element_text(hjust = 0.5))\r\n  })\r\n}\r\n\r\nshinyApp(ui, server)\r\n","type":"text"}]
